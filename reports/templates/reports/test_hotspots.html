{% extends "base.html" %}
<!DOCTYPE html>
<html>
<head>
    <title>Hotspot Test</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        #map { height: 500px; width: 100%; }
        .debug { margin: 10px; padding: 10px; background: #f0f0f0; }
    </style>
</head>
<body>
    <h1>Hotspot Test Page</h1>
    <div class="debug" id="debug"></div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize map
        var map = L.map('map').setView([12.9716, 77.5946], 12);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);

        // Test hotspot data
        fetch('/reports/hotspots/data/')
            .then(response => {
                console.log('Response status:', response.status);
                return response.json();
            })
            .then(hotspots => {
                console.log('Hotspots received:', hotspots);
                document.getElementById('debug').innerHTML = 
                    `<strong>Hotspots found:</strong> ${hotspots.length}<br>
                     <strong>Data:</strong> ${JSON.stringify(hotspots, null, 2)}`;
                
                hotspots.forEach((hotspot, index) => {
                    console.log(`Creating hotspot ${index}:`, hotspot);
                    
                    const circle = L.circle([hotspot.lat, hotspot.lng], {
                        color: 'darkred',
                        fillColor: '#ff5555',
                        fillOpacity: 0.4,
                        radius: 300
                    }).addTo(map);

                    circle.bindPopup(`
                        üß† <b>Hotspot #${index + 1}</b><br>
                        üìç <b>Address:</b> ${hotspot.address}<br>
                        üßæ <b>Reports:</b> ${hotspot.report_count}<br>
                        üìç <b>Coords:</b> ${hotspot.lat}, ${hotspot.lng}
                    `);
                });
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('debug').innerHTML = `<strong>Error:</strong> ${error.message}`;
            });
    </script>
</body>
</html> 