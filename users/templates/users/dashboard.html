{% extends "base.html" %}
{% load static %}
{% block content %}

<div class="dashboard-container">
    <h2>Welcome back</h2>
    <p><strong>Username:</strong> {{ request.user.username }}</p>
    <p><strong>Email:</strong> {{ request.user.email }}</p>
    <p><strong>Phone:</strong>
      {% if profile.phone_number and profile.phone_number != "N/A" %}
          {{ profile.phone_number }}
      {% else %}
          need to set it up
      {% endif %}
  </p>
  
  

    <h3>Your Reports</h3>
    {% if reports %}
        {% for report in reports %}
            <div style="margin-bottom:25px;padding:15px;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);">
                <h4>Report {{ forloop.counter }}</h4>
                <p><strong>Status:</strong> {{ report.status }}</p>
                <p><strong>Address:</strong> {{ report.address }}</p>
                <p><strong>Submitted at:</strong> {{ report.submitted_at }}</p>
                {% if report.photo %}
                    <img src="{{ report.photo.url }}" class="report-photo" 
                         style="width:150px;cursor:pointer;border-radius:5px;box-shadow:0 2px 6px rgba(0,0,0,0.3);" 
                         onclick="openModal(this)">
                {% else %}
                    <em>No photo provided</em>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p>No reports yet.</p>
    {% endif %}
</div>

<!-- Modal -->
<div id="imgModal" 
     style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;
            background:rgba(0,0,0,0.75);justify-content:center;align-items:center;transition:0.3s;">
    
    <span onclick="closeModal()" 
          style="position:absolute;top:20px;right:30px;font-size:30px;color:white;
                 cursor:pointer;font-weight:bold;">&#10005;</span>
    
    <img id="modalImg" 
         style="max-width:80%;max-height:80%;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.5);">
</div>

<script>
function openModal(imgElement) {
    var modal = document.getElementById("imgModal");
    var modalImg = document.getElementById("modalImg");
    modal.style.display = "flex";
    modalImg.src = imgElement.src;
}

function closeModal() {
    document.getElementById("imgModal").style.display = "none";
}
</script>

{% endblock %}
